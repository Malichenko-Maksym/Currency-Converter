<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>GBP to PLN exchange</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="../static/style.css">

</head>

<body>
<div class="container">
    <div class="child">
        <div class="currency">
            <label>You send</label>
            <p><select id="firstCur" name="firstCur" onchange="doSm1()" th:action="@{/firstCur}" th:object="${cur}">
                <option disabled selected value="none">First currency</option>
                <option value="usd" >USD</option>
                <option value="eur">EUR</option>
                <option value="jpy">JPY</option>
                <option value="gbp">GBP</option>
                <option value="chf">CHF</option>
                <option value="pln">PLN</option>
            </select>
                :
                <input id="firstCurInp" type="number" class="icon" min="0" step="any" onkeydown="return event.keyCode !== 69 && event.keyCode !== 109 && event.keyCode !== 107
                    && event.keyCode !== 189 && event.keyCode !== 187"></p>
        </div>

        <div class="currency">
            <label >They receive</label>
            <p> <select id="secondCur" name="secondCur" onchange="doSm2()">
                <option disabled selected value="none">Second currency</option>
                <option value="usd">USD</option>
                <option value="eur">EUR</option>
                <option value="jpy">JPY</option>
                <option value="gbp">GBP</option>
                <option value="chf">CHF</option>
                <option value="pln">PLN</option>
            </select>
                :
                <input id="secondCurInp" type="number" min="0" step="any" onkeydown="return event.keyCode !== 69 && event.keyCode !== 109 && event.keyCode !== 107
                    && event.keyCode !== 189 && event.keyCode !== 187"></p>

        </div>
        <p id="rate"></p>
        <p>No transfer fee</p>


    </div>
</div>

<script th:inline="javascript">
    let firstCurSel = document.getElementById('firstCur');
    let secondCurSel = document.getElementById('secondCur');
    var exchangeRate = /*[[${exchangeRate}]]*/ "";
    //document.getElementById("rate").innerHTML = "1 "+firstCurSel.value+" = " + (exchangeRate).toFixed(2) + " "+secondCurSel.value;
    let currencyGBP = document.getElementById('firstCurInp');
    let currencyPLN = document.getElementById('secondCurInp');


    currencyGBP.addEventListener('input', calculatePLN);
    currencyPLN.addEventListener('input', calculateGBP);

    function calculatePLN() {
        currencyPLN.value = (currencyGBP.value * exchangeRate).toFixed(2);
    }

    function calculateGBP() {
        currencyGBP.value = (currencyPLN.value / exchangeRate).toFixed(2);
    }

    // let firstCur = document.getElementById('firstCur');
    // currencyGBP.addEventListener('click', doSm);


    function doSm1() {
        alert(firstCurSel.value);
        changeInfo();
    }

    function doSm2() {
        alert(secondCurSel.value);
        changeInfo();
    }

    function  changeInfo() {
        if (firstCurSel.value!="none" && secondCurSel.value!="none"){
            document.getElementById("rate").innerHTML = "1 "+firstCurSel.value+" = " + (exchangeRate).toFixed(2) + " "+secondCurSel.value;
        }

    }
</script>

</body>
</html>